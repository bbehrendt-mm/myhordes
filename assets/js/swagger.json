{
  "openapi": "3.0.2",
  "info": {
    "title": "MyHordes External API",
    "description": "This documentation describes the MyHordes external API. It is currently work-in-progress.",
    "license": {
      "name": "AGPL3",
      "url": "https://spdx.org/licenses/AGPL-3.0-or-later.html"
    },
    "version": "1.0.0.42"
  },
  "servers": [
    {
      "url": "/api/x/",
      "description": "MyHordes API Server"
    }
  ],
  "tags": [
    {
      "name": "XML API",
      "description": "Implements the older XML API"
    },
    {
      "name": "JSON API",
      "description": "Implements the newer Twinoid JSON API"
    }
  ],
  "paths": {
    "/v2/xml": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Returns a list of available endpoints",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLEndpointList"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/user": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "User information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLUserResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/items": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Item information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLGeneralResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/buildings": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Building information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLGeneralResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/ruins": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Ruin information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLGeneralResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/pictos": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Picto information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLGeneralResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    },
    "/v2/xml/town": {
      "get": {
        "tags": [
          "XML API"
        ],
        "summary": "Town information.",
        "responses": {
          "200": {
            "description": "List",
            "content": {
              "application/xml": {
                "schema": {
                  "$ref": "#/components/schemas/XMLGeneralResponse"
                }
              }
            }
          }
        },
        "security": [
          {"secret_key":[]},
          {"user_key":[]}
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "XMLGeneralResponse": {
        "description": "This schema has not been defined yet.",
        "type": "object",
        "properties": {},
        "xml": {
          "name": "hordes"
        }
      },
      "XMLEndpointList": {
        "description": "List of available endpoints",
        "type": "object",
        "properties": {
          "user": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/user"
          },
          "items": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/items"
          },
          "buildings": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/buildings"
          },
          "ruins": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/ruins"
          },
          "pictos": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/pictos"
          },
          "town": {
            "type": "string",
            "example": "https:/myhordes.de/api/x/v2/xml/town"
          }
        },
        "xml": {
          "name": "hordes"
        }
      },
      "XMLUserResponse": {
        "description": "Contains information regarding the current user.",
        "type": "object",
        "properties": {
          "headers": {
            "$ref": "#/components/schemas/XMLHeaderObject"
          },
          "data": {
            "type": "object",
            "properties": {
              "cache-date": {
                "type": "string",
                "format": "datetime",
                "description": "Date at which this object was generated",
                "example": "2022-07-16 20:00:00",
                "xml": {
                  "attribute": true
                }
              },
              "cache-fast": {
                "type": "integer",
                "minimum": 0,
                "maximum": 0,
                "example": 0,
                "description": "Will usually be 0.",
                "xml": {
                  "attribute": true
                }
              },
              "rewards": {
                "$ref": "#/components/schemas/XMLRewardListObject"
              },
              "maps": {
                "$ref": "#/components/schemas/XMLMapListObject"
              },
              "imported-maps": {
                "$ref": "#/components/schemas/XMLImportedMapListObject"
              }
            }
          }
        },
        "xml": {
          "name": "hordes"
        }
      },

      "XMLCitizenObject": {
        "description": "Describes a citizen.",
        "type": "object",
        "properties": {
          "dead": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this citizen dead (1) or alive (0)",
            "xml": {
              "attribute": true
            }
          },
          "hero": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Does this citizen play with a heroic profession (1) or not (0)",
            "xml": {
              "attribute": true
            }
          },
          "name": {
            "type": "string",
            "description": "Player name",
            "example": "Dayan",
            "xml": {
              "attribute": true
            }
          },
          "avatar": {
            "type": "string",
            "description": "Avatar URL",
            "example": "42/e8b3ac08be0c72dba1a9731fc48c4eff.jpeg",
            "xml": {
              "attribute": true
            }
          },
          "id": {
            "type": "integer",
            "description": "Unique user ID",
            "example": 42,
            "xml": {
              "attribute": true
            }
          },
          "ban": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this citizen shunned (1) or not (0)",
            "xml": {
              "attribute": true
            }
          },
          "job": {
            "type": "string",
            "description": "Job identifier",
            "example": "collec",
            "enum": ["none", "basic", "collec", "guardian", "hunter", "tamer", "tech", "shaman", "survivalist"],
            "xml": {
              "attribute": true
            }
          },
          "out": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this citizen outside (1) or in town (0)",
            "xml": {
              "attribute": true
            }
          },
          "x": {
            "type": "integer",
            "description": "X Position on the map (when outside)",
            "example": 5,
            "xml": {
              "attribute": true
            }
          },
          "y": {
            "type": "integer",
            "description": "Y Position on the map (when outside)",
            "example": -2,
            "xml": {
              "attribute": true
            }
          }
        },
        "xml": {
          "name": "citizen"
        }
      },
      "XMLOwnerObject": {
        "description": "Describes the current user.",
        "type": "object",
        "properties": {
          "citizen": {
            "$ref": "#/components/schemas/XMLCitizenObject"
          },
          "myZone": {
            "$ref": "#/components/schemas/XMLMyZoneObject"
          }
        },
        "xml": {
          "name": "owner"
        }
      },
      "XMLItemObject": {
        "description": "An item",
        "type": "object",
        "properties": {
          "count": {
            "type": "integer",
            "description": "Number of items in this stack.",
            "example": 1,
            "xml": {
              "attribute": true
            }
          },
          "id": {
            "type": "integer",
            "description": "Item type ID",
            "example": 2,
            "xml": {
              "attribute": true
            }
          },
          "cat": {
            "type": "string",
            "description": "Item category",
            "example": "Rsc",
            "enum": ["Armor","Box","Drug","Food","Furniture","Misc","Rsc","Weapon"],
            "xml": {
              "attribute": true
            }
          },
          "broken": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this item broken (1) or not (0)",
            "xml": {
              "attribute": true
            }
          },
          "name": {
            "type": "string",
            "description": "Item name (depends on language)",
            "example": "Batterie",
            "xml": {
              "attribute": true
            }
          }
        },
        "xml": {
          "name": "item"
        }
      },
      "XMLMyZoneObject": {
        "description": "An item",
        "type": "object",
        "properties": {
          "dried": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this zone dried (1) or not (0)",
            "xml": {
              "attribute": true
            }
          },
          "h": {
            "type": "integer",
            "description": "Human control points",
            "example": 2,
            "xml": {
              "attribute": true
            }
          },
          "z": {
            "type": "integer",
            "description": "Number of zombies",
            "example": 1,
            "xml": {
              "attribute": true
            }
          },
          "item": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/XMLItemObject"
            },
            "xml": {
              "wrapped": false
            }
          }
        },
        "xml": {
          "name": "myZone"
        }
      },
      "XMLShortGameObject": {
        "description": "Information about the current town.",
        "type": "object",
        "properties": {
          "days": {
            "type": "integer",
            "example": 4,
            "description": "Current day",
            "xml": {
              "attribute": true
            }
          },
          "quarantine": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Will usually be 0. In case of a game error, this may be set to 1. We recommend to cease further processing of this stream in case this property is set to 1.",
            "xml": {
              "attribute": true
            }
          },
          "datetime": {
            "type": "string",
            "format": "datetime",
            "description": "Current date",
            "example": "2022-07-16 20:00:00",
            "xml": {
              "attribute": true
            }
          },
          "id": {
            "type": "integer",
            "description": "Unique town ID",
            "example": 1467,
            "xml": {
              "attribute": true
            }
          }
        },
        "xml": {
          "name": "game"
        }
      },
      "XMLHeaderObject": {
        "description": "Common information about the API and the current user",
        "type": "object",
        "properties": {
          "link": {
            "type": "string",
            "description": "The current API endpoint",
            "example": "https:///myhordes.localhost/api/x/v2/xml/user",
            "xml": {
              "attribute": true
            }
          },
          "iconurl": {
            "type": "string",
            "description": "Prefix for icon URLs",
            "example": "https:///myhordes.localhost/build/images",
            "xml": {
              "attribute": true
            }
          },
          "avatarurl": {
            "type": "string",
            "description": "Prefix for avatar URLs",
            "example": "https:///myhordes.localhost/build/images",
            "xml": {
              "attribute": true
            }
          },
          "secure": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 1,
            "description": "Is this API call authorized (1) or not (0). For non-authorized requests, the amount of available information is limited.",
            "xml": {
              "attribute": true
            }
          },
          "author": {
            "type": "string",
            "description": "Name of the API generator",
            "example": "MyHordes",
            "xml": {
              "attribute": true
            }
          },
          "language": {
            "type": "string",
            "description": "Current language",
            "example": "de",
            "enum": ["de","en","fr","es"],
            "xml": {
              "attribute": true
            }
          },
          "version": {
            "type": "string",
            "description": "API version",
            "example": "0.1",
            "xml": {
              "attribute": true
            }
          },
          "generator": {
            "type": "string",
            "description": "API framework",
            "example": "symfony",
            "xml": {
              "attribute": true
            }
          },
          "owner": {
            "$ref": "#/components/schemas/XMLOwnerObject"
          },
          "game": {
            "$ref": "#/components/schemas/XMLShortGameObject"
          }
        },
        "xml": {
          "name": "headers"
        }
      },
      "XMLRewardObject": {
        "description": "Earned reward",
        "type": "object",
        "properties": {
          "rare": {
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "example": 0,
            "description": "Is this reward rare (1) or not (0).",
            "xml": {
              "attribute": true
            }
          },
          "n": {
            "type": "integer",
            "example": 10,
            "description": "Picto count",
            "xml": {
              "attribute": true
            }
          },
          "img": {
            "type": "string",
            "description": "Picto URL",
            "example": "pictos/r_pande.gif",
            "xml": {
              "attribute": true
            }
          },
          "name": {
            "type": "string",
            "description": "Picto name (depends on language)",
            "example": "Überlebende der Hölle!",
            "xml": {
              "attribute": true
            }
          },
          "desc": {
            "type": "string",
            "description": "Picto description (depends on language)",
            "example": "Sie sind ein wahrer Überlebenskünstler der Hölle.",
            "xml": {
              "attribute": true
            }
          },
          "title": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Title name (depends on language)",
                  "example": "Hölle, das esse ich jeden Morgen.",
                  "xml": {
                    "attribute": true
                  }
                }
              }
            },
            "xml": {
              "name": "title",
              "wrapped": false
            }
          }
        },
        "xml": {
          "name": "r"
        }
      },
      "XMLRewardListObject": {
        "description": "List of pictos",
        "type": "object",
        "properties": {
          "r": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/XMLRewardObject"}
          }
        },
        "xml": {
          "name": "rewards"
        }
      },
      "XMLMapObject": {
        "description": "Played map",
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Town name",
            "example": "Gespenstische Soldaten",
            "xml": {
              "attribute": true
            }
          },
          "season": {
            "type": "integer",
            "example": 15,
            "minimum": 0,
            "description": "Town season",
            "xml": {
              "attribute": true
            }
          },
          "score": {
            "type": "integer",
            "example": 21,
            "minimum": 0,
            "description": "Town score",
            "xml": {
              "attribute": true
            }
          },
          "d": {
            "type": "integer",
            "example": 6,
            "minimum": 0,
            "description": "Survived days",
            "xml": {
              "attribute": true
            }
          },
          "id": {
            "type": "integer",
            "example": 2,
            "minimum": 0,
            "description": "Unique Town ID",
            "xml": {
              "attribute": true
            }
          },
          "v1": {
            "type": "integer",
            "example": 0,
            "minimum": 0,
            "maximum": 1,
            "description": "Old town; can only be true for imported towns.",
            "xml": {
              "attribute": true
            }
          },
          "origin": {
            "type": "string",
            "description": "Origin of an imported town",
            "example": "de",
            "enum": ["de","en","fr","es"],
            "xml": {
              "attribute": true
            }
          },
          "phase": {
            "type": "string",
            "description": "Describes the origin of the town.",
            "example": "alpha",
            "enum": ["alpha","beta","native","import"],
            "xml": {
              "attribute": true
            }
          }
        },
        "xml": {
          "name": "m"
        }
      },
      "XMLMapListObject": {
        "description": "List of maps",
        "type": "object",
        "properties": {
          "m": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/XMLMapObject"}
          }
        },
        "xml": {
          "name": "maps"
        }
      },
      "XMLImportedMapListObject": {
        "description": "List of imported maps (imported into MyHordes, but for the primary soul)",
        "type": "object",
        "properties": {
          "m": {
            "type": "array",
            "items": {"$ref": "#/components/schemas/XMLMapObject"}
          }
        },
        "xml": {
          "name": "imported-maps"
        }
      }
    },
    "requestBodies": {
    },
    "securitySchemes": {
      "secret_key": {
        "type": "apiKey",
        "name": "appkey",
        "in": "query",
        "description": "Application key. You can obtain this key by contacting the Technical Support. For testing purposes, you may use the following key: <code>fefe0000fefe0000fefe0000fefe0000</code>. This key is only valid in combination with a test user key."
      },
      "user_key": {
        "type": "apiKey",
        "name": "userkey",
        "in": "query",
        "description": "User key. This key is transmitted to your application when users visit it over the Application Directory. For testing purposes, you may use the following key: <code>fefe0000fefe0000fefe0000fefe0000</code>. This key is only valid when you're actively logged into MyHordes and will resolve to your own user account. Together with the secret test key, it can be used to test the API without the need of registering for a secret key."
      }
    }
  }
}