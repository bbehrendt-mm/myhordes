{% extends "ajax/game/town/town.html.twig" %}
{% block content %}

    <div class="help">
        {% trans from 'game' %}
            Mithilfe des Wachturms kann die Stärke des nächtlichen Angriffs abgeschätzt werden. Je mehr Bürger sich an der Abschätzung beteiligen, desto genauer wird das Ergebnis.
        {% endtrans %}
    </div>

    <h5>{{ 'Heutige Abschätzung'|trans({},'game') }}</h5>
    <div class="row">
        <div class="padded cell rw-4 rw-md-6 left">
            <b>{{ z0[2] }} - {{ z0[3] }}</b> <img alt="{{ 'Zombies'|trans({},'game') }}" src="{{ asset('build/images/small_zombie.gif') }}" />
        </div>
        <div class="padded cell rw-4 rw-md-6 center small">
            <div class="watchtower-prediction">
                <p>{{ 'Qualität der Abschätzung'|trans({},'game') }}</p>
                <div class="watchtower-prediction-bar">
                    <div class="watchtower-prediction-progress" style="width: {{ z0[4] }}%;"></div>
                    <div class="watchtower-prediction-text" style="width: {{ z0[4] }}%;">{{ z0[4] }}%</div>
                </div>
            </div>
        </div>
        <div class="padded cell rw-4 ro-md-6 rw-md-6 ro-sm-0 rw-sm-12 right">
            {% if z0[4] < 100 %}
                <button {% if not z0_av %}disabled{% endif%} x-predict-attack="0">{{ 'Abschätzung verbessern'|trans({},'game') }}</button>
            {% endif %}
        </div>
    </div>

    {% if z1[0] %}
        <h5>{{ 'Morgige Abschätzung'|trans({},'game') }}</h5>
        <div class="row">
            <div class="padded cell rw-4 rw-md-6 left">
                {% if z1[1] %}
                    <b>{{ z1[2] }} - {{ z1[3] }}</b> <img alt="{{ 'Zombies'|trans({},'game') }}" src="{{ asset('build/images/small_zombie.gif') }}" />
                {% else %}
                    <b>???</b> <img alt="{{ 'Zombies'|trans({},'game') }}" src="{{ asset('build/images/small_zombie.gif') }}" />
                {% endif %}
            </div>
            <div class="padded cell rw-4 rw-md-6 center small">
                {% if z1[1] %}
                    <div class="watchtower-prediction">
                        <p>{{ 'Qualität der Abschätzung'|trans({},'game') }}</p>
                        <div class="watchtower-prediction-bar">
                            <div class="watchtower-prediction-progress" style="width: {{ z1[4] }}%;"></div>
                            <div class="watchtower-prediction-text" style="width: {{ z1[4] }}%;">{{ z1[4] }}%</div>
                        </div>
                    </div>
                {% endif %}
            </div>
            <div class="padded cell rw-4 ro-md-6 rw-md-6 ro-sm-0 rw-sm-12 right">
                {% if z1[1] %}
                    <button {% if not z1_av %}disabled{% endif%} x-predict-attack="1">{{ 'Abschätzung verbessern'|trans({},'game') }}</button>
                {% endif %}
            </div>
        </div>

    {% endif %}

    <div class="small-note">
        {% trans from 'game' %}
            Wow, von hier oben kannst du praktisch alles sehen! Schade nur, dass dieses 'alles' sich auf eine leere Sandwüste beschränkt. Wenn du ganz genau hinschaust, kannst du jedoch die Zombies zählen, die sich Richtung Stadt schleppen.
        {% endtrans %}
    </div>
{% endblock %}
{% block js %}
    {{ parent() }}
    <script>
        let buttons = document.querySelectorAll('[x-predict-attack]');
        for (let i = 0; i < buttons.length; i++)
            buttons[i].addEventListener('click', function() {
                const day = this.getAttribute('x-predict-attack');
                $.ajax.easySend( '{{ path('town_watchtower_estimate_controller') }}', {day: day},
                    function () {
                        $.ajax.load(null, '{{ path('town_watchtower') }}', true);
                    } );
            });
    </script>
{% endblock %}