{% extends "ajax/ajax.html.twig" %}
{% block ajax %}
    <div class="row soul">
        <div class="cell padded header rw-8">
            <h4>{% trans from 'soul' %}Deine Seele{% endtrans %}</h4>

            <div class="row">
                {# TODO: Distinguish heroïc soul and non-heroïc souls #}
                <div class="cell padded rw-2"><img src="{{ asset('build/images/small_ghost_red.gif') }}" alt="Héros" /> {{ app.user.username }}</div>
                <div class="cell padded rw-8 center">{{ app.user.email }}</div>
                <div class="cell padded rw-2 right"><a target="_self" href="{{ path('auto_logout') }}">{{ 'Ausloggen'|trans({},'global') }}</a></div>
            </div>

            <div class="row">
                <div class="cell padded rw-5 rw-sm-12 distinctions">
                    <div class="distinctions-head center">
                        {{ 'Statistiken'|trans({}, 'global') }}
                    </div>
                    <div class="distinctions-list center">
                        <div class="overall">
                            {{ '%points% Punkte'|trans({'%points%':0}, 'global') }}
                        </div>
                        <div class="top"></div>
                        <div class="list empty">
                            {{ 'Dieser Spieler hat bisher noch keine Preise gewonnen...'|trans({}, 'global') }}
                        </div>
                    </div>
                    <div class="distinctions-foot">
                        &nbsp;
                    </div>
                </div>
                <div class="cell padded rw-7 rw-sm-12">

                    <div class="score"><img src="{{ asset('build/images/soul/small_score.gif') }}" alt="" /> {{ 'Seelenpunktzahl'|trans({}, 'global') }} : <strong>{{ '%points% Punkte'|trans({'%points%': app.user.soulPoints}, 'global') }}</strong></div>

                    {% for incarnations in app.user.citizens %}
                        {% if incarnations.alive %}
                            <div class="current">
                                <em>{{'Aktuelles Leben'|trans({}, 'global')}} : </em><br /><strong><img src="{{ asset('build/images/soul/r_explor.gif') }}" alt="" /> {{ incarnations.town.name }}</strong> ({{ 'Tag %day%'|trans({'%day%':incarnations.town.day}, 'game') }})
                            </div>
                        {% set days = incarnations.survivedDays %}
                        {% set nbSoulPoints = days * ( days + 1 ) / 2 %}
                        {% endif %}
                    {% endfor %}

                    <div class="town-history">
                        <div class="row header">
                            <div class="cell padded rw-2 center">
                                {{'Saison'|trans({}, 'global')}}
                            </div>
                            <div class="cell padded rw-6 center">
                                {{'Stadt'|trans({}, 'game')}}
                            </div>
                            <div class="cell padded rw-2 center">
                                {{'Tage'|trans({}, 'global')}}
                            </div>
                            <div class="cell padded rw-2 center">
                                {{'Punkte'|trans({}, 'global')}}
                            </div>
                        </div>
                        <div class="town-container">
                        {% for incarnations in app.user.citizens|filter(incarnations => not incarnations.alive) %}
                            <div class="row">
                            {% if not incarnations.alive %}
                                {% set days = incarnations.survivedDays %}
                                {% set nbSoulPoints = days * ( days + 1 ) / 2 %}
                                    <div class="cell padded rw-2 center">
                                        0
                                    </div>
                                    <div class="cell padded rw-6 center town-name">
                                        {{ incarnations.town.name }}
                                    </div>
                                    <div class="cell padded rw-2 center town-days bold">
                                        {{ incarnations.survivedDays }}
                                    </div>
                                    <div class="cell padded rw-2 center town-points bold">
                                        +{{nbSoulPoints}}
                                    </div>
                            </div>
                            {% endif %}
                        {% else %}
                            <div class="row">
                                <div class="empty">
                                    {{'Es wurde keine Stadt gefunden...'|trans({}, 'global')}}
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}