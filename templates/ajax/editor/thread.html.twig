{% extends "ajax/ajax_plain.html.twig" %}

{# @var permission \App\Structures\ForumPermissionAccessor #}

{% block ajax_base %}
    <hordes-twino-editor
        data-context="{{ "forum" ~ (town_controls ? '-tc' : '') }}"
        data-pm-mode="0"
        data-username="{{ username }}" data-user="{{ app.user.id }}"
        data-header="{{ 'Neuer Thread'|trans({},'global') }}"
        data-feature-alias="{{ alias ? 1 : 0 }}"
        data-feature-title="1"
        data-feature-preview="1"
        data-redirect-after-submit="1"

        data-target-url="{{ path('forum_new_thread_controller', {id: fid}) }}"
        data-target-map="html:text,role:type,title,tag"

        data-feature-tags="{{ tags is not empty ? 1 : 0 }}"
        data-tags="{{ tags|map(t => t.name ~ ':' ~ t.label|trans({},'global'))|join(',') }}"

        data-control="extended"
        data-control-glory="{{ app.user|has_unlocked('f_glory') ? 1 : 0 }}"
        data-control-rp="{{ town_controls ? 1 : 0 }}"
        data-control-image="{{ (permission.format_admin() or permission.format_oracle()) ? 1 : 0 }}"
        data-control-admin="{{ permission.format_admin() ? 1 : 0 }}"
        data-control-oracle="{{ permission.format_oracle() ? 1 : 0 }}"
        data-control-poll="{{ permission.format_oracle() ? 1 : 0 }}"
        data-control-mod="{{ permission.format_mod() ? 1 : 0 }}"
        data-control-snippet="{{ (permission.format_admin() or permission.format_oracle() or permission.format_mod()) ? 1 : 0 }}"

        {% if permission.alt_post_mode() %}
            data-with-role-user="{{ app.user.name }}"
            data-default-role="{{ app.user.postAsDefault }}"
            {% if permission.post_as_animacteur() %}
                data-with-role-anim="{{ 'Animateur'|trans({},'admin') }}"
            {% endif %}
            {% if permission.post_as_crow() %}
                data-with-role-crow="{{ 'Der Rabe'|trans({},'global') }}"
            {% endif %}
            {% if permission.post_as_dev() %}
                data-with-role-dev="{{ 'Entwickler'|trans({},'global') }}"
            {% endif %}
        {% endif %}
    ></hordes-twino-editor>
{% endblock %}