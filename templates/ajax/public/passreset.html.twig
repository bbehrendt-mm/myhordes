{% extends "ajax/ajax.html.twig" %}
{% block menu_bar %}
    <div class="header-stats">
        <ul>
            <li><span class='count'>{{deadCitizenCount|number_format(0, ',', ' ')}}</span> {{'Bürger gestorben'|trans({}, 'welcome')}}</li>
            <li><span class='count'>{{zombiesKilled|number_format(0, ',', ' ')}}</span> {{'Zombies gekillt'|trans({}, 'welcome')}}</li>
            <li><span class='count'>{{canibalismCount|number_format(0, ',', ' ')}}</span> {{'Akte von Kannibalismus'|trans({}, 'welcome')}}</li>
            <li class="end-stat">{{'Und das wird kaum besser werden...'|trans({}, 'welcome')}}</li>
        </ul>
    </div>
{% endblock %}
{% block ajax %}
    <div class="row">
        <div class="cell padded header rw-8 ro-2 rw-lg-12 ro-lg-0">
            <h4>{% trans from 'login' %}Passwort zurücksetzen{% endtrans %}</h4>
            <p class="justify">
                {% trans from 'login' %}Bitte gib deine E-Mail Adresse ein.{% endtrans %}
            </p>
            <form id="recover-form">
                <div class="row">
                    <div class="cell padded-small rw-6 rw-md-12"><b><label for="recover-mail">{% trans from 'login' %}E-Mail Adresse{% endtrans %}</label></b></div>
                    <div class="cell padded-small rw-6 rw-md-12"><input name="mail" id="recover-mail" type="text" /></div>
                </div>
                <br />
                <div class="row">
                    <div class="cell padded-small rw-6 rw-md-12"><b><label for="recover-password1">{% trans from 'login' %}Passwort{% endtrans %}</label></b></div>
                    <div class="cell padded-small rw-6 rw-md-12"><input name="pass1" id="recover-password1" type="password" /></div>
                </div>
                <div class="row">
                    <div class="cell padded-small rw-6 rw-md-12"><b><label for="recover-password2">{% trans from 'login' %}Passwort{% endtrans %}</label></b></div>
                    <div class="cell padded-small rw-6 rw-md-12"><input name="pass2" id="recover-password2" type="password" /></div>
                </div>
            </form>
            <p class="right small">
                <a href="" x-ajax-href="{{ path('public_login') }}">{% trans from 'login' %}Login!{% endtrans %}</a>
            </p>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script>
        document.getElementById('login_button').addEventListener('click', function(e) {
            e.preventDefault();
            $.ajax.easySend( '{{ path('api_login') }}', $.html.serializeForm(document.getElementById('login-form')),
                function (data) {
                    if (data.require_validation) $.ajax.load(null, '{{ path('public_validate') }}', true);
                    else $.ajax.load(null, '{{ path('initial_landing') }}', true);
                }, {'default': '{% trans from 'login' %}Login fehlgeschlagen. Bitte prüfe deine Eingaben.{% endtrans %}'} )
        });
    </script>
{% endblock %}